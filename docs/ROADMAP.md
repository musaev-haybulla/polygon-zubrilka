
# План развития проекта

Этот документ описывает ближайшие планы по развитию проекта.

## Добавление озвучек

Процесс добавления новой озвучки будет состоять из нескольких шагов, чтобы обеспечить гибкость и качество.

1.  **Загрузка и основная информация.** На первом этапе пользователь указывает основную информацию об озвучке (чей голос, тип — AI/человек, название) и загружает сам аудиофайл.
**Статус** Выполнено

2.  **Выбор порядка сортировки.** Пользователю будет предложен выпадающий список для определения позиции новой озвучки. Варианты будут включать "Добавить первым" и названия уже существующих озвучек, что позволит разместить новую запись сразу после выбранной.
**Статус** Выполнено

3.  **Разделение озвучек в интерфейсе.** В `poem_list.php` необходимо визуально разделить озвучки на `активные` и `черновики`. Для каждой озвучки в статусе `draft` должны быть доступны опции для редактирования метаинформации, обрезки исходного аудиофайла и перехода к этапу разметки.
**Статус** Выполнено

4.  **Редактирование метаинформации озвучки.** ✅ **Выполнено**
    - Реализовано модальное окно для редактирования метаданных (название, тип голоса, порядок сортировки)
    - Добавлена возможность загрузки нового аудиофайла (опционально)
    - Создан класс `AudioSorter` для правильной нормализации порядка сортировки
    - Реализована AJAX-обработка для обновления интерфейса без перезагрузки
    
    **Подзадачи для доработки:**
    - 4a. ✅ Добавить кнопки для продолжения workflow: "Сохранить и обрезать", "Сохранить и разметить"
    - 4b. ✅ Убрать чекбокс "Обрезать аудиофайл" из модалки редактирования (избежать путаницы)
    - 4c. ✅ Реализовать переходы к соответствующим этапам обработки озвучки
**Статус** Выполнено

5.  **Загрузка и привязка озвучек к фрагментам.** Для каждого фрагмента стихотворения будет добавлена возможность загрузить индивидуальный аудиофайл. Процесс будет реализован через AJAX для лучшего пользовательского опыта. На сервере файл будет проходить валидацию (формат, размер), сохраняться в структурированную директорию (например, `uploads/audio/{poem_id}/{fragment_id}.mp3`). Думаю, необходимо задействовать ajax для загрузки аудио, чтобы улучшить взаимодействие пользователя с интерфейсом
**Статус** В фокусе

6.  **Опциональная обрезка файла.** После загрузки аудиофайла в базу данных добавляется запись со статусом `draft`. Если пользователь выбирает обрезку, система сохраняет исходный файл как `original` и создает новую, урезанную версию как `current`. Это позволяет возвращаться к редактированию без необходимости повторной загрузки файла. 

7.  **Интеграция разметки.** На последнем этапе происходит разметка аудио по тексту. После успешного завершения этого шага статус записи в базе данных меняется на `active`.
